import{getUserData as p}from"@decentraland/Identity";import{getCurrentRealm as u,getPlatform as f}from"@decentraland/EnvironmentAPI";var v="https://europe-west3-backend-339310.cloudfunctions.net/customEvent",y="dcl-v00",o=async(r,a={})=>{let{userId:s,displayName:i,hasConnectedWeb3:e,publicKey:m}=await p(),{serverName:l,room:n}=await u()??{},c=await f(),t={eventType:r,userId:e?m:s,displayName:i,hasConnectedWeb3:e,realmName:l,realmRoom:n,platform:c,eventVersion:y,...a};t.realmName!=="localhost"&&fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})};import{getParcel as w}from"@decentraland/ParcelIdentity";var b=async()=>{let r=0,a=0,s=await w(),{cid:i}=s,e="dcl:"+s.land.sceneJsonData.scene.base;onEnterSceneObservable.add(async t=>{r=Date.now(),log("enter!!!"),o("enterLand",{itemId:e})}),onLeaveSceneObservable.add(t=>{let d=Math.floor(Date.now()-r);o("visitDuration",{itemId:e,duration:d})}),onPlayerConnectedObservable.add(t=>{a=Date.now(),o("connectLand",{itemId:e})}),onPlayerDisconnectedObservable.add(t=>{let d=Math.floor(Date.now()-a);o("connectionDuration",{itemId:e,duration:d})});let l=`https://europe-west3-backend-339310.cloudfunctions.net/serve/${e}.jpg`,n=new Entity,c=new BasicMaterial;return c.texture=new Texture(l,{wrap:0}),n.addComponent(c),n.addComponent(new Transform({position:new Vector3(0,0,0)})),engine.addEntity(n),{parcelId:i,itemId:e}};export{b as registerDclEvents};
