import{getUserData as m}from"@decentraland/Identity";import{getCurrentRealm as p,getPlatform as f}from"@decentraland/EnvironmentAPI";var y="https://europe-west3-backend-339310.cloudfunctions.net/customEvent",u="dcl-v00",o=async(a,r={})=>{let{userId:s,displayName:c,hasConnectedWeb3:e,publicKey:t}=await m(),{serverName:n,room:i}=await p()??{},d=await f(),l={eventType:a,userId:e?t:s,displayName:c,hasConnectedWeb3:e,realmName:n,realmRoom:i,platform:d,eventVersion:u,...r};l.realmName!=="localhost"&&fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})};import{getParcel as v}from"@decentraland/ParcelIdentity";var b=async()=>{let a=0,r=0,s=await v(),{cid:c}=s,e="dcl:"+s.land.sceneJsonData.scene.base;return onEnterSceneObservable.add(async t=>{a=Date.now(),log("enter!!!"),o("enterLand",{itemId:e})}),onLeaveSceneObservable.add(t=>{let n=Math.floor(Date.now()-a);o("visitDuration",{itemId:e,duration:n})}),onPlayerConnectedObservable.add(t=>{r=Date.now(),o("connectLand",{itemId:e})}),onPlayerDisconnectedObservable.add(t=>{let n=Math.floor(Date.now()-r);o("connectionDuration",{itemId:e,duration:n})}),{parcelId:c,itemId:e}};export{b as registerDclEvents};
